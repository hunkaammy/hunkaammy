<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube DJ Player with Volume Control</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            background: linear-gradient(135deg, #2c3e50, #bdc3c7);
            color: white;
            padding: 20px;
            box-sizing: border-box;
        }

        h1 {
            text-align: center;
            margin-bottom: 15px;
            color: #ECF0F1;
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.7);
            font-size: 24px;
        }

        h3 {
            text-align: center;
            color: #ECF0F1;
            margin-bottom: 10px;
            font-size: 20px;
        }

        .track-control-container {
            display: flex; /* Flex container for track selection */
            justify-content: space-around;
            width: 100%;
            max-width: 600px;
            margin: 20px 0;
        }

        .track-selector {
            margin-right: 10px;
            flex: 1;
        }

        .track-list-container  {
    margin-bottom: 15px;
    background-color: rgba(44, 62, 80, 0.8);
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
    width: 100%;
    max-width: 600px;
    margin-top: 20px;
}

        select,
        input[type="text"] {
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
            border: none;
            width: 100%;
            background-color: #34495e;
            color: white;
            margin-top: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }

        input[type="text"]::placeholder {
            color: #ecf0f1;
        }

        label {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .player-container {
            display: flex; /* Align players inline */
            justify-content: space-between; /* Space between players */
            margin-bottom: 15px;
            width: 100%;
        }

        .video-player {
            flex: 1; /* Make players take equal space */
            margin: 0 5px; /* Add margin to separate slightly */
            border: 2px solid #2c3e50;
            border-radius: 10px;
            overflow: hidden;
            padding: 5px;
        }

        .volume-control {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            width: 100%;
        }

        .volume-slider {
            width: 80%;
            margin-right: 5px;
        }

        .volume-level {
            font-weight: bold;
            font-size: 14px;
        }

        .add-track-container {
            margin-top: 10px;
        }

        .add-track-btn {
            padding: 8px 12px;
            font-size: 14px;
            margin-left: 10px;
            cursor: pointer;
            background-color: #2980b9;
            color: white;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s;
            width: 100%;
        }

        .add-track-btn:hover {
            background-color: #3498db;
        }

        .track-list-container ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .track-list-container li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background-color: rgba(44, 62, 80, 0.7);
            margin-bottom: 10px;
            border-radius: 5px;
        }

        button {
            padding: 5px 10px;
            cursor: pointer;
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s;
            font-size: 14px;
            width: 45%;
            margin: 0;
        }

        button:hover {
            background-color: #c0392b;
        }

        .track-list-container button:nth-child(2) {
            background-color: #f39c12;
        }

        .track-list-container button:nth-child(2):hover {
            background-color: #e67e22;
        }

        @media (max-width: 600px) {
            .track-control-container {
             
                align-items: stretch;
            }

            .player-container {

    justify-content: space-between;
    margin-bottom: 15px;
    width: 100%;
}

            .video-player {
                margin: 10px 0; /* Add vertical margin when stacked */
                width: 100%; /* Make players full width */
            }
        }
    </style>
</head>
<body>
    <h1>YouTube DJ Player</h1>
    <div class="track-control-container">
	
	 <div class="track-selector">
            <label for="track-list2">DECK-1:</label>
            <select id="track-list2"></select>
        </div>
	
        <div class="track-selector">
            <label for="track-list1">DECK-2:</label>
            <select id="track-list1"></select>
        </div>
       
    </div>
    <div class="player-container">
      
        <div class="video-player" id="player2">
            <iframe id="youtube-player2" width="100%" height="315" src="https://www.youtube.com/embed?autoplay=1&enablejsapi=1" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
		
		
		  <div class="video-player" id="player1">
            <iframe id="youtube-player1" width="100%" height="315" src="https://www.youtube.com/embed?autoplay=1&enablejsapi=1" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
    </div>
    
    <div class="volume-control">
        <input type="range" id="volume1" class="volume-slider" min="0" max="100" value="50">
        <span id="volume-level1" class="volume-level">50</span>
    </div>
    <div class="volume-control" style="display:none;">
        <input type="range" id="volume2" class="volume-slider" min="0" max="100" value="50">
        <span id="volume-level2" class="volume-level">50</span>
    </div>

    <div class="add-track-container">
        <input type="text" id="track-url-input" placeholder="Enter full YouTube URL">
        <input type="text" id="track-name-input" placeholder="Enter track name">
        <button id="add-track-btn" class="add-track-btn">Add Track</button>
    </div>
    
<div class="track-list-container">
    <h3>Saved Tracks</h3>
    <ul id="track-list"></ul>
    <button id="download-playlist-btn" class="add-track-btn">Download Playlist</button>
    <div class="add-track-container">
        <input type="file" id="import-playlist-input" accept=".csv" style="display: none;">
        <label for="import-playlist-input" class="add-track-btn">Import Playlist</label>
    </div>
</div>

    <div class="track-list-container">
        <h3>Saved Tracks</h3>
        <ul id="track-list"></ul>
    </div>

    <script>
        // Function to load YouTube API
        function loadYouTubeAPI() {
            const script = document.createElement('script');
            script.src = "https://www.youtube.com/iframe_api";
            document.body.appendChild(script);
        }

        let player1, player2;

        function onYouTubeIframeAPIReady() {
            player1 = new YT.Player('youtube-player1', {
                events: {
                    'onReady': onPlayerReady1
                }
            });
            player2 = new YT.Player('youtube-player2', {
                events: {
                    'onReady': onPlayerReady2
                }
            });
        }

        function onPlayerReady1() {
            player1.setVolume(50);
        }

        function onPlayerReady2() {
            player2.setVolume(50);
        }

        const volumeControl1 = document.getElementById('volume1');
        const volumeLevel1 = document.getElementById('volume-level1');

        volumeControl1.addEventListener('input', function() {
            const volume = volumeControl1.value;
            player1.setVolume(volume);
            player2.setVolume(100 - volume);
            volumeLevel1.textContent = volume;
        });

        const volumeControl2 = document.getElementById('volume2');
        const volumeLevel2 = document.getElementById('volume-level2');

        volumeControl2.addEventListener('input', function() {
            const volume = volumeControl2.value;
            player2.setVolume(volume);
            player1.setVolume(100 - volume);
            volumeLevel2.textContent = volume;
        });

        const trackList1 = document.getElementById('track-list1');
        const trackList2 = document.getElementById('track-list2');

        // Function to update both select dropdowns with saved tracks
        function updateSelectLists() {
            trackList1.innerHTML = '';
            trackList2.innerHTML = '';
            const savedTracks = JSON.parse(localStorage.getItem('tracks')) || [];

            savedTracks.forEach((track) => {
                const option1 = document.createElement('option');
                option1.value = track.url;
                option1.textContent = track.name;
                trackList1.appendChild(option1);

                const option2 = document.createElement('option');
                option2.value = track.url;
                option2.textContent = track.name;
                trackList2.appendChild(option2);
            });
        }

        // Load and update the track list
        function updateTrackList() {
            const trackList = document.getElementById('track-list');
            trackList.innerHTML = ''; // Clear previous tracks
            
            const savedTracks = JSON.parse(localStorage.getItem('tracks')) || [];

            if (savedTracks.length === 0) {
                return;
            }

            savedTracks.forEach((track, index) => {
                const listItem = document.createElement('li');
                listItem.textContent = `${track.name} - ${track.url}`;
                
                // Edit button
                const editButton = document.createElement('button');
                editButton.textContent = 'Edit';
                editButton.onclick = () => {
                    const newName = prompt('Enter new track name:', track.name);
                    const newUrl = prompt('Enter new track URL:', track.url);
                    if (newName && newUrl) {
                        track.name = newName;
                        track.url = newUrl;
                        localStorage.setItem('tracks', JSON.stringify(savedTracks));
                        updateTrackList(); // Refresh the list
                        updateSelectLists(); // Refresh the dropdowns
                    }
                };

                // Delete button
                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'Delete';
                deleteButton.onclick = () => {
                    savedTracks.splice(index, 1); // Remove the track from the array
                    localStorage.setItem('tracks', JSON.stringify(savedTracks));
                    updateTrackList(); // Refresh the list
                    updateSelectLists(); // Refresh the dropdowns
                };

                listItem.appendChild(editButton);
                listItem.appendChild(deleteButton);
                trackList.appendChild(listItem);
            });
        }

        // Adding default tracks if none exist
        function addDefaultTracks() {
            const defaultTracks = [
                { name: "Track 1", url: "https://www.youtube.com/watch?v=dQw4w9WgXcQ" },
                { name: "Track 2", url: "https://www.youtube.com/watch?v=kJQP7kiw5Fk" }
            ];
            localStorage.setItem('tracks', JSON.stringify(defaultTracks));
            updateTrackList();
            updateSelectLists();
        }

        // Event listener for adding tracks
        document.getElementById('add-track-btn').addEventListener('click', function() {
            const trackName = document.getElementById('track-name-input').value;
            const trackUrl = document.getElementById('track-url-input').value;

            if (trackName.trim() === '' || trackUrl.trim() === '') {
                alert('Both track name and URL are required!');
                return;
            }



            // Get saved tracks
            const savedTracks = JSON.parse(localStorage.getItem('tracks')) || [];
            savedTracks.push({ name: trackName, url: trackUrl });
            localStorage.setItem('tracks', JSON.stringify(savedTracks));
            updateTrackList(); // Refresh the list
            updateSelectLists(); // Refresh the dropdowns

            // Clear the input fields
            document.getElementById('track-name-input').value = '';
            document.getElementById('track-url-input').value = '';
        });

        // Function to load selected video in players when an option is selected
        function loadSelectedTrack(player, trackUrl) {
            const videoId = extractYouTubeId(trackUrl);
            if (videoId) {
                player.loadVideoById(videoId, 0); // Load the video by ID into the player
            }
        }

        // Helper function to extract the YouTube video ID from a URL, including shortened URLs
        function extractYouTubeId(url) {
            const regex = /(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|(?:.+[?&]v=)|(?:.*[&]v=)|(?:v(?:\/|=))?)|youtu\.be\/)([^"&?\/\s]{11})/;
            const match = url.match(regex);
            return match && match[1] ? match[1] : null;
        }

        // Event listeners for when a track is selected from the dropdowns
        trackList1.addEventListener('change', function() {
            const selectedTrackUrl = trackList1.value;
            loadSelectedTrack(player1, selectedTrackUrl);
        });

        trackList2.addEventListener('change', function() {
            const selectedTrackUrl = trackList2.value;
            loadSelectedTrack(player2, selectedTrackUrl);
        });


// Function to download the saved tracks as a text file
function downloadPlaylist() {
    const savedTracks = JSON.parse(localStorage.getItem('tracks')) || [];
    if (savedTracks.length === 0) {
        alert('No tracks saved to download.');
        return;
    }

    // Create CSV representation of the tracks
    const playlistContent = savedTracks.map(track => `${track.name},${track.url}`).join('\n');
    const blob = new Blob([playlistContent], { type: 'text/csv' });

    // Create a link element to trigger the download
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'playlist.csv'; // Name of the downloaded file
    document.body.appendChild(link);
    
    // Programmatically click the link to trigger the download
    link.click();
    
    // Clean up
    document.body.removeChild(link);
}

// Event listener for the download button
document.getElementById('download-playlist-btn').addEventListener('click', downloadPlaylist);

// Function to handle file input change
document.getElementById('import-playlist-input').addEventListener('change', function(event) {
    const file = event.target.files[0];
    
    if (file) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            const contents = e.target.result;
            parseCSV(contents);
        };
        
        reader.readAsText(file);
    }
});

// Function to parse the CSV and update localStorage
function parseCSV(data) {
    const lines = data.split('\n');
    const savedTracks = JSON.parse(localStorage.getItem('tracks')) || [];

    lines.forEach(line => {
        const [name, url] = line.split(',').map(item => item.trim());
        
        if (name && url) {
            savedTracks.push({ name, url });
        }
    });

    // Save updated tracks to localStorage
    localStorage.setItem('tracks', JSON.stringify(savedTracks));
    updateTrackList(); // Refresh the track list display
    updateSelectLists(); // Refresh dropdowns
    alert('Playlist imported successfully!');
}

        // Initialize the page by adding default tracks if no tracks are saved in localStorage
        window.onload = function() {
            const savedTracks = JSON.parse(localStorage.getItem('tracks'));
            if (!savedTracks || savedTracks.length === 0) {
                addDefaultTracks();
            } else {
                updateTrackList();
                updateSelectLists();
            }
        };

        // Load YouTube API script
        loadYouTubeAPI();
    </script>
</body>
</html>
